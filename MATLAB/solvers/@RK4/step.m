%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% Step method for RK4 class
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
function y = step(obj, ode_fun, y0)
%
%   Step forward in time
%
    k1 = ode_fun(obj.t, y0);
    k2 = ode_fun(obj.t + 0.5 * obj.h, y0 + obj.h * 0.5 * k1);
    k3 = ode_fun(obj.t + 0.5 * obj.h, y0 + obj.h * 0.5 * k2);
    k4 = ode_fun(obj.t + obj.h, y0 + obj.h * k3);
    y = y0 + (obj.h / 6) * (k1 + 2 * k2 + 2 * k3 + k4);
end
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% End
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%